# Release 0.2.0

Released: 2025-10-23

Highlights
---------

- Bug fixes and internal refactors to improve stability when freezing complex host objects.
- Extraction of defensive helpers to make audit/error reporting more robust and easier to test.

What's new
----------

- Fix: `freezeDeep` and `safeFreeze` were repaired after an accidental file corruption. The implementation is now resilient to host errors when traversing prototypes, getters/setters and symbols.
- Refactor: Extracted `safeCall` into a small, well-tested helper that accepts an `auditFailures` array and a context path. This centralizes error-auditing logic and reduces duplication.
- Internal: The check for skipped keys (`options.skipKeys`) is now pulled into a descriptive local variable to make intent and error-handling clearer.

Included ADRs
--------------

- ADR 0004 — Integrity attestation (docs/adr/0004-integrity-attestation.md) is included as part of the release. This documents the chosen approach for attesting build/runtime integrity and how fingerprints/hashes are produced and verified.
	Note: the fingerprint verification/attestation flow is experimental in this release — it's provided for early validation and may change in follow-up releases.
- ADR 0005 — Playwright testing (docs/adr/0005-playwright-testing.md) is included. It documents the testing approach used for browser e2e scenarios and the CI wiring for Playwright tests used in the repo.

Bug fixes and polish
--------------------

- Removed stray/duplicated import lines and accidental markdown/code-fence remnants that previously caused parse errors during build.
- All call-sites that may throw while inspecting object graphs are now wrapped with the shared `safeCall` helper and report failures to the `auditFailures` collector instead of throwing.
- Defensive guards added when iterating keys and descriptors to avoid host-dependent exceptions.

Tests and quality
-----------------

- Tighter TypeScript checks added in CI; the codebase compiles cleanly under `npx tsc --noEmit`.
- Linting and formatting applied to the updated files.

Upgrade notes
-------------

- This release is backwards-compatible at the public API surface. The internal refactor is an implementation detail and should not affect callers other than making audit reporting more predictable.
- If you previously relied on the library to throw for auditing failures, note that now most host errors are collected in the `auditFailures` array passed to `freezeDeep`/`safeFreeze`.

Files changed (high level)
-------------------------

- `src/utils/freeze.ts` — fixed implementation and refactors (extracted `safeCall`, descriptive skip-key variable, robust audit push behavior).

Try it
------

- Run typecheck:

```bash
npx tsc --noEmit
```

- Run tests (vitest):

```bash
npm run test
```

Notes / next steps
------------------

- Consider adding unit tests that explicitly assert that `auditFailures` receives expected entries when host errors are simulated (e.g., property descriptors that throw from getters).
- Consider exposing a small helper to format `auditFailures` into human-readable reports for CI logs.

